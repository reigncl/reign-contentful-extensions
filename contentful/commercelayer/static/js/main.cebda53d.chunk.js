(this["webpackJsonp@contentful/commercelayer-products"]=this["webpackJsonp@contentful/commercelayer-products"]||[]).push([[0],{249:function(e,t,n){"use strict";n.r(t);var i=n(89),a=n(48),o=n.n(a),r=n(84),c=n.n(r),s=n(85),l=n.n(s),p=n(49),d=n.p+"static/media/logo.73d2f416.svg",u=n(11),m=n.n(u);const f=e=>t=>{const{id:n}=t;return{id:n,image:m()(t,["imageUrl"])||m()(t,["attributes","image_url"]),name:m()(t,["name"])||m()(t,["attributes","name"]),sku:m()(t,["code"])||m()(t,["attributes","code"]),externalLink:`${e}/admin/skus/${n}/edit`}},h="root";let y=null;function g(e){return"Array"===e?"Select products":"Select a product"}function w(e){return e.clientId.length<1?"Provide your application client ID.":e.clientSecret.length<1?"Provide your application client secret.":e.apiEndpoint.length<1||!e.apiEndpoint.startsWith("https://")?"Provide a valid application Base endpoint.":null}async function k(e,t,n){return y||(y=(await i.a.getIntegrationToken({clientId:e,endpoint:t.startsWith("https://")?t:`https://${t}`,clientSecret:n})).accessToken),y}const v=async function(e,t){if(!e.length)return[];const{clientId:n,apiEndpoint:i,clientSecret:a}=t,r=await k(n,i,a),s=c()(e,25).map((async e=>{const t=`${i}/api/skus?page[size]=25&filter[q][code_in]=${e}`,n=await fetch(t,{headers:{Accept:"application/vnd.api+json",Authorization:`Bearer ${r}`},method:"GET"});return await n.json()})),p=await Promise.all(s),d=l()(p,(({data:e})=>e.map(f(t.apiEndpoint)))),u=o()(e,d.map((e=>e.sku))).map((e=>({sku:e,isMissing:!0,image:"",name:"",id:""})));return[...d,...u]};Object(p.setup)({makeCTA:g,name:"Commerce Layer",logo:d,description:"The Commerce Layer app allows editors to select products from their Commerce Layer account and reference them inside of Contentful entries.",color:"#212F3F",parameterDefinitions:[{id:"clientId",name:"Client ID",description:"The client ID of your application",type:"Symbol",required:!0},{id:"clientSecret",name:"Client Secret",description:"The client secret of your application",type:"Symbol",required:!0},{id:"apiEndpoint",name:"API Endpoint",description:'Application Base endpoint (e.g., "https://acme.commercelayer.io")',type:"Symbol",required:!0}],fetchProductPreviews:v,renderDialog:async function(e){const t=document.getElementById(h);t.style.display="flex",t.style.flexDirection="column",Object(p.renderSkuPicker)(h,{sdk:e,fetchProductPreviews:v,fetchProducts:async(t,n)=>{const i=await async function(e,t,n){const i=w(e);if(i)throw new Error(i);const{clientId:a,apiEndpoint:o,clientSecret:r}=e,c=await k(a,o,r),s=`${o}/api/skus?page[size]=20&page[number]=${n.offset/20+1}${t.length?`&filter[q][name_or_code_cont]=${t}`:""}`,l=await fetch(s,{headers:{Accept:"application/vnd.api+json",Authorization:`Bearer ${c}`},method:"GET"});return await l.json()}(e.parameters.installation,t,n);return{pagination:{count:20,limit:20,total:i.meta.record_count,offset:n.offset},products:i.data.map(f(e.parameters.installation.apiEndpoint))}}}),e.window.startAutoResizer()},openDialog:async function(e,t,n){const i=await e.dialogs.openCurrentApp({allowHeightOverflow:!0,position:"center",title:g(e.field.type),shouldCloseOnOverlayClick:!0,shouldCloseOnEscapePress:!0,parameters:n,width:1400});return Array.isArray(i)?i:[]},isDisabled:function(){return!1},validateParameters:w})},93:function(e,t){}},[[249,1,2]]]);
//# sourceMappingURL=main.cebda53d.chunk.js.map